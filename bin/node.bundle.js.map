{"version":3,"sources":["webpack:///webpack/bootstrap 8ecf8bdd572f9b13b1d2","webpack:///external \"lodash\"","webpack:///./src/outgoing.js","webpack:///./src/index.js","webpack:///./src/incoming.js","webpack:///external \"lru-cache\"","webpack:///./src/umm.js","webpack:///./src/actions.js","webpack:///external \"bluebird\"","webpack:///./src/zalo.js","webpack:///external \"zalo-sdk\"","webpack:///external \"eventemitter2\"","webpack:///./src/utils.js"],"names":["handlePromise","next","promise","then","console","log","res","catch","err","handleText","event","zalo","getClient","api","uid","raw","userId","message","text","module","exports","outgoingMiddleware","platform","outgoing","type","initializeZalo","bp","configurator","loadAll","config","Zalo","enabled","logger","warn","oaID","required","default","env","secretKey","init","helpers","middlewares","register","name","order","handler","description","ready","_internal","messagesCache","max","maxAge","on","e","fromuid","sendIncoming","user","id","getUserId","processOutgoing","blocName","instruction","ins","Object","assign","_","isNil","strRep","util","inspect","Error","at","renderers","registerConnector","args","templates","createText","create","resolve","reject","Promise","r","rj","messageId","Date","toISOString","Math","random","newEvent","__id","obj","zOAClient","ZaloOA","oaid","secretkey","setConfig","app","getRouter","auth","test","req","originalUrl","_initWebhook","get","query","msgid","_handleEvent","sendStatus","emit","EventEmitter","sanitizeUserId","replace"],"mappings":"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","file":"node.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/Users/leducduy/Downloads/emszalo/botpress-zalo\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8ecf8bdd572f9b13b1d2","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 0\n// module chunks = 0","import {sanitizeUserId} from './utils'\nconst handlePromise = (next, promise) => {\n  return promise\n    .then(res => {\n      console.log('success')\n      console.log(res)\n      next()\n      return res\n    })\n    .catch(err => {\n      console.log('error')\n      console.log(err)\n      next(err)\n      throw err\n    })\n}\n\nconst handleText = (event, next, zalo) => {\n  return handlePromise(\n    next,\n    zalo.getClient().api('sendmessage/text', 'POST', {uid: sanitizeUserId(event.raw.userId), message: event.text})\n  )\n}\n\nmodule.exports = {\n  text: handleText\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/outgoing.js","/*\n  Botpress module template. This is your module's entry point.\n  Please have a look at the docs for more information about config, init and ready.\n  https://botpress.io/docs\n*/\n\nimport _ from 'lodash'\nimport outgoing from './outgoing'\nimport incoming from './incoming'\nimport UMM from './umm'\nimport Zalo from './zalo'\nlet zalo = null\n\nconst outgoingMiddleware = (event, next) => {\n  if (event.platform !== 'zalo') {\n    return next()\n  }\n\n  if (!outgoing[event.type]) {\n    return next('Unsupported event type: ' + event.type)\n  }\n\n  return outgoing[event.type](event, next, zalo)\n}\n\nconst initializeZalo = async (bp, configurator) => {\n  const config = await configurator.loadAll()\n\n  zalo = new Zalo(bp, config)\n  // users = Users(bp, messenger)\n\n  const enabled = config.enabled\n\n  if (!enabled) {\n    return bp.logger.warn('[Messenger] Connection disabled')\n  }\n\n  return zalo\n  //   .connect()\n  //   .then(() => messenger.updateSettings())\n  //   .catch(err => bp.logger.error(err))\n}\n\nmodule.exports = {\n  config: {\n    oaID: { type: 'string', required: true, default: '', env: 'ZALO_OA_ID' },\n    secretKey: { type: 'string', required: true, default: '', env: 'ZALO_SECRET_KEY' },\n    enabled: { type: 'bool', required: true, default: true }\n  },\n\n  // eslint-disable-next-line no-unused-vars\n  init: async (bp, configurator, helpers) => {\n    bp.middlewares.register({\n      name: 'zalo.sendMessages',\n      type: 'outgoing',\n      order: 101,\n      handler: outgoingMiddleware,\n      module: 'botpress-zalo',\n      description:\n        'Sends out messages that targets platform = zalo. This middleware should be placed at the end as it swallows events once sent.'\n    })\n\n    bp.zalo = {}\n\n    UMM(bp) // Initializes Zalo in the UMM\n  },\n\n  // eslint-disable-next-line no-unused-vars\n  ready: async (bp, configurator, helpers) => {\n    // Your module's been loaded by Botpress.\n    // Serve your APIs here, execute logic, etc.\n\n    await initializeZalo(bp, configurator)\n    incoming(bp, configurator, zalo)\n    bp.zalo._internal = zalo\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import LRU from 'lru-cache'\nimport _ from 'lodash'\nimport outgoing from './outgoing'\n\nmodule.exports = (bp, config, zalo) => {\n  const messagesCache = LRU({\n    max: 10000,\n    maxAge: 60 * 60 * 1000\n  })\n\n  zalo.on('sendmsg', (e) => {\n    const {message, fromuid} = e\n    bp.middlewares.sendIncoming({\n      platform: 'zalo',\n      type: 'message',\n      user: {id: `zalo:${fromuid}`},\n      text: message,\n      raw: e\n    })\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/incoming.js","module.exports = require(\"lru-cache\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lru-cache\"\n// module id = 5\n// module chunks = 0","import _ from 'lodash'\nimport {createText} from './actions'\n\nfunction getUserId(event) {\n  return event.user.id\n}\n\nfunction processOutgoing({ event, blocName, instruction }) {\n  const ins = Object.assign({}, instruction) // Create a shallow copy of the instruction\n\n  if (!_.isNil(instruction.text)) {\n    return createText(getUserId(event), instruction.text)\n  }\n\n  const strRep = util.inspect(instruction, false, 1)\n  throw new Error(`Unrecognized instruction on Zalo in bloc '${blocName}': ${strRep}`)\n}\n\n\nmodule.exports = bp => {\n  const [renderers, registerConnector] = _.at(bp, ['renderers', 'renderers.registerConnector'])\n\n  renderers &&\n    registerConnector &&\n    registerConnector({\n      platform: 'zalo',\n      processOutgoing: args => processOutgoing(Object.assign({}, args, { bp })),\n      templates: []\n    })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/umm.js","import Promise from 'bluebird'\nimport _ from 'lodash'\n\nconst create = obj => {\n  let resolve = null\n  let reject = null\n  const promise = new Promise((r, rj) => {\n    resolve = r\n    reject = rj\n  })\n\n  const messageId = new Date().toISOString() + Math.random()\n  const newEvent = Object.assign(\n    {\n      // _promise: promise,\n      // _resolve: resolve,\n      // _reject: reject,\n      __id: messageId\n    },\n    obj\n  )\n\n  return newEvent\n}\n\nexport function createText(userId, text) {\n  return create({\n    platform: 'zalo',\n    text,\n    type: 'text',\n    raw: {userId, text}\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/actions.js","module.exports = require(\"bluebird\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bluebird\"\n// module id = 8\n// module chunks = 0","import {ZaloOA} from 'zalo-sdk'\nimport EventEmitter from 'eventemitter2'\nexport default class Zalo extends EventEmitter {\n  constructor(bp, config) {\n    super()\n    this.zOAClient = new ZaloOA({\n      oaid: config.oaID,\n      secretkey: config.secretKey\n    });\n\n    this.setConfig(config)\n    this.bp = bp\n\n    this.app = bp.getRouter('botpress-zalo', {\n      'bodyParser.json': false,\n      auth: req => !/\\/webhook/i.test(req.originalUrl)\n    })\n\n    // this.app.use(\n    //   bodyParser.json({\n    //     verify: this._verifyRequestSignature.bind(this)\n    //   })\n    // )\n\n    this._initWebhook()\n  }\n\n  getClient() {\n    return this.zOAClient;\n  }\n\n  setConfig(config) {\n    this.config = Object.assign({}, this.config, config)\n  }\n  getConfig() {\n    return this.config\n  }\n\n  _initWebhook() {\n    this.app.get('/webhook', (req, res) => {\n\n      const {event, message, fromuid, msgid} = req.query;\n      switch (event) {\n        case 'sendmsg':\n        this._handleEvent(event, {message, fromuid, msgid})\n        break;\n        default:\n\n        break;\n      }\n\n      // Must send back a 200 within 20 seconds or the request will time out.\n      res.sendStatus(200)\n    })\n  }\n\n  _handleEvent(type, event) {\n    this.emit(type, event)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/zalo.js","module.exports = require(\"zalo-sdk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"zalo-sdk\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"eventemitter2\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"eventemitter2\"\n// module id = 11\n// module chunks = 0","export function sanitizeUserId(userId) {\n  return userId.replace(/zalo:/gi, '')\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js"],"sourceRoot":""}